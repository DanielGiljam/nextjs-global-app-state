[`GlobalAppStatePropertyParameters`] in [`nextjs-global-app-state@2.0.0`]

---

This is how you describe a global app state property. We're talking about an object literal that has certain properties defined on it.

All properties (and properties of properties) are optional and skipping them (not defining them) simply means the resulting global app state property won't be implementing any behavior of the skipped kind. Exceptions to this rule are the properties marked as required as well as the boolean property [`isSensitiveInformation`] that defaults to `false` and the [`controlContext`] properties to which special constraints apply.

#### Summary:

- [`key`](required)
- [`defaultValue`](required)
- [`defaultValues`](required)
- [`keyPlural`]
- [`isSensitiveInformation`]
- [`initializeValue`]
  - [`initializeValue.serverSide`]
  - [`initializeValue.clientSide`]
- [`getValues`]
  - [`getValues.serverSide`]
  - [`getValues.clientSide`]
- [`setValue`]
- [`controlContext`]
  - [`controlContext.Context`]
  - [`controlContext.ContextProvider`]
  - [`controlContext.transformValue`]
  - [`controlContext.isAsync`]
  - [`controlContext.isSerializable`]

---

### `key` (required)

Type: `string`

This will be the name of your global app state property.

### `defaultValue` (required)

Type: `any`

A default state value for your global app state property to fall back to if all attempts initializing/restoring state would fail. Must be a valid value — or in other words, the value must exist in [`defaultValues`].

### `defaultValues` (required)

Type: `any[]`

An array of values enumerating the states that will be regarded as valid states for your global app state property to be in.

#### Example

In the case of [`theme`], the [`defaultValues`] are `"auto"`, `"light"` and `"dark"`.

#### Remarks

You've just encountered the library's biggest limitation at the moment. As of now, allowing a global app state property to have any value as its state isn't natively supported. Neither are other forms of validating state values such as dynamic validation functions. But these are features that will be added in the future.

### `keyPlural`

Type: `string`

A custom plural form for the [`key`] of your global app state property. If you don't like the plural form generated by the library based on the [`key`], then you can specify how the plural form should look here.

#### Example

[`lang`] has a custom plural form for its [`key`]. In our opinion `"langs"` doesn't sound too good so we specified [`keyPlural`] as `"languages"`.

### `isSensitiveInformation`

Type: `boolean`

Indicates that your global app state property should be treated as sensitive information. Defaults to `false`.

#### Remarks

In practice, it doesn't do anything right now. But in the future this will have to do with how the state of your global app state property is stored, depending on whether the client has given consent to cookies or not.

### `initializeValue`

Type: `object`

An object literal containing functions that initialize/restore the state of your global app state property, server-side and client-side respectively.

#### `initializeValue.serverSide`

Type: `function`

```ts
function serverSide(
  values: Set<any>,
  defaultValue: any,
  cookies: Cookies,
  req: IncomingMessage
): any | Promise<any>;
```

A function for initializing/restoring the state of your global app state property server-side when performing an on-demand server-side render. The function must return a valid state value synchronously or asynchronously, it's up to you. You can expect that the following arguments are passed to the function:

- `values`<br>A set of values enumerating the states that are regarded as valid states for your global app state property
- `defaultValue`<br>This global app state property's [`defaultValue`]
- `cookies`<br>An object literal representing any cookies sent with the client's request (see [`Cookies`])
- `req`<br>The request itself (see documentation for [`IncomingMessage`])

#### `initializeValue.clientSide`

Type: `function`

```ts
function clientSide(values: Set<any>, existingValue: any): any | Promise<any>;
```

A function for initializing/restoring the state of your global app state property client-side when the [`App`] component has mounted. The function must return a valid state value either synchronously or asynchronously, it's up to you. You can expect that following arguments are passed to the function:

- `values`<br>A set of values enumerating the states that are regarded as valid states for your global app state property
- `existingValue`<br>A pre-existing state value or the [`defaultValue`]

### `getValues`

Type: `object`

An object literal containing functions that retrieve an array of values enumerating the states that will be regarded as valid states for your global app state property. The arrays returned by these functions override the [`defaultValues`].

#### Remarks

These functions are run alongside the [`initializeValue`] functions, in other words when performing a on-demand server-side render and when the [`App`] component mounts. These functions are not run when the state of your global app state property changes.

#### Example

In [`lang`] you can supply [`getSupportedLanguages`] as an option, which basically is an alias for [`getValues`]. This allows the set of supported languages to be dynamic rather than hard-coded. For instance, the set can be fetched from a database or a JSON file hosted on a static path, let's say `/supported-languages.json`.

#### `getValues.serverSide`

Type: `function`

```ts
function serverSide(): any[] | Promise<any[]>;
```

A function for retrieving the array of values server-side. The function can either be synchronous or asynchronous, it's up to you.

#### `getValues.clientSide`

Type: `function`

```ts
function clientSide(): any[] | Promise<any[]>;
```

A function for retrieving the array of values client-side. The function can either be synchronous or asynchronous, it's up to you.

### `setValue`

Type: `function`

```ts
function setValue(
  values: Set<any>,
  cookieConsent: CookieConsent,
  value: any
): Promise<void>;
```

A function that gets invoked when the state of your global app state property is explicitly changed. The function must be asynchronous. You can expect that following arguments are passed to the function:

- `values`<br>A set of values enumerating the states that are regarded as valid states for your global app state property
- `cookieConsent`<br>Indicates whether the client has given consent to cookies or not (see [`CookieConsent`])
- `value`<br>The state value that your global app state property is being set to

### `controlContext`

Type: `object`

An object literal. Lets you link your global app state property to a [`React.Context`], such that the state of your global app state property controls what data is in the [`Context`][`react.context`]. If [`controlContext`] is defined, [`controlContext.Context`] and/or [`controlContext.ContextProvider`] must also be defined.

#### Example

[`lang`] controls a [`Context`][`react.context`] which provides string resources (text shown in the UI). When state of [`lang`] changes, the string resources change accordingly. You can have the language of your entire UI change instantaneously, without having to reload the page or lose any state at all.

#### `controlContext.Context`

Type: [`React.Context`]

A [`React.Context`].

#### `controlContext.ContextProvider`

Type: [`React.Context.Provider`]

It doesn't strictly have to be a [`Context.Provider`][`react.context.provider`]. It just has to be similar enough — more specifically, it has to be a component that wraps its children and takes a prop called `value`.

#### `controlContext.transformValue`

Type: `function`

```ts
function transformValue(value: any): any | Promise<any>;
```

A transformation that is applied to the state value of your global app state property before it's placed into the [`Context`][`react.context`]. The transformation can either be synchronous or asynchronous, but if it's asynchronous, you have to indicate it using the [`controlContext.isAsync`] flag.

#### Example

In [`lang`], the lang code which is the state value is transformed into an entire set of string resources before it's placed into the [`Context`][`react.context`] controlled by [`lang`]. In this case [`controlContext.transformValue`] retrieves string resources based on the lang code provided to it as an argument.

#### `controlContext.isAsync`

Type: `boolean`

Indicates that [`controlContext.transformValue`] is defined and returns a [`Promise`] (is asynchronous). Defaults to `false`.

#### `controlContext.isSerializable`

Type: `boolean`

Indicates that [`controlContext.transformValue`] is defined and returns or (if it's a [`Promise`]) resolves to something that can be serialized server-side by [Next.js] and then hydrated client-side. Defaults to `false`.

---

## Miscellaneous Types

### `Cookies`

```ts
type Cookies = { [key: string]: string };
```

An object literal representation of cookies.

#### Example

The cookie string `"lang=en; theme=auto"` would be represented as `{ lang: "en", theme: "auto" }`.

### `CookieConsent`

```ts
type CookieConsent = boolean | null;
```

Indicates whether the client has given consent to cookies or not. If `true`, then consent has been given. If `false`, then consent has been explicitly withheld. If `null`, then consent hasn't been given nor has it been withheld.

[`globalappstatepropertyparameters`]: https://github.com/DanielGiljam/nextjs-global-app-state/blob/master/legacy-docs/v2.0.0/GlobalAppStatePropertyParameters.md
[`key`]: #key-required
[`defaultvalue`]: #defaultValue-required
[`defaultvalues`]: #defaultValues-required
[`keyplural`]: #keyPlural
[`issensitiveinformation`]: #isSensitiveInformation
[`initializevalue`]: #initializeValue
[`initializevalue.serverside`]: #initializeValueServerSide
[`initializevalue.clientside`]: #initializeValueClientSide
[`getvalues`]: #getValues
[`getvalues.serverside`]: #getValuesServerSide
[`getvalues.clientside`]: #getValuesClientSide
[`setvalue`]: #setValue
[`controlcontext`]: #controlContext
[`controlcontext.context`]: #controlContextContext
[`controlcontext.contextprovider`]: #controlContextContextProvider
[`controlcontext.transformvalue`]: #controlContextTransformValue
[`controlcontext.isasync`]: #controlContextIsAsync
[`controlcontext.isserializable`]: #controlContextIsSerializable
[`cookies`]: #cookies
[`cookieconsent`]: #cookieConsent
[`lang`]: https://github.com/DanielGiljam/nextjs-global-app-state/blob/master/legacy-docs/v2.0.0/lang.md
[`getsupportedlanguages`]: https://github.com/DanielGiljam/nextjs-global-app-state/blob/master/legacy-docs/v2.0.0/lang.md#getSupportedLanguages
[`theme`]: https://github.com/DanielGiljam/nextjs-global-app-state/blob/master/legacy-docs/v2.0.0/theme.md
[`nextjs-global-app-state@2.0.0`]: https://www.npmjs.com/package/nextjs-global-app-state/v/2.0.0
[`incomingmessage`]: https://nodejs.org/api/http.html#http_class_http_incomingmessage
[`app`]: https://nextjs.org/docs/advanced-features/custom-app
[next.js]: https://nextjs.org
[`react.context`]: https://reactjs.org/docs/context.html
[`react.context.provider`]: https://reactjs.org/docs/context.html#contextprovider
[`promise`]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise
